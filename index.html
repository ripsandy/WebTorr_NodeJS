<!DOCTYPE html>
<html>
<head>
  <title>WebTorrent Hybrid</title>
</head>
<body>
  <h1>WebTorrent Hybrid</h1>
  <form id="torrentForm">
    <label for="magnetURIs">Magnet URIs (separated by commas):</label>
    <input type="text" id="magnetURIs" name="magnetURIs" required>
    <button type="submit">Download</button>
  </form>

  <div id="progressContainer">
    <h2>Progress:</h2>
    <div id="progressBars"></div>
  </div>

  <script type="module">
    import { createTorrentClient } from './torrentClient.mjs';

    const form = document.getElementById('torrentForm');
    const input = document.getElementById('magnetURIs');
    const progressContainer = document.getElementById('progressContainer');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const magnetURIs = input.value.split(',').map(uri => uri.trim());
      await downloadTorrents(magnetURIs);
    });

    const downloadTorrents = async (magnetURIs) => {
      magnetURIs.forEach((magnetURI) => {
        const progressBar = document.createElement('div');
        progressBar.classList.add('progressBar');
        progressBar.innerHTML = `
          <div class="progressLabel">${magnetURI}</div>
          <div class="barContainer">
            <div class="bar"></div>
          </div>
        `;
        progressContainer.appendChild(progressBar);
      });

      try {
        await createTorrentClient(magnetURIs);
      } catch (err) {
        console.error('Error downloading torrents:', err);
      }
    };
  </script>

  <style>
    .progressBar {
      margin-bottom: 10px;
    }

    .progressLabel {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .barContainer {
      width: 100%;
      background-color: #eee;
    }

    .bar {
      height: 20px;
      background-color: #4CAF50;
      width: 0%;
      transition: width 0.3s ease-in-out;
    }
  </style>
</body>
</html>